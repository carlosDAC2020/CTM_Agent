<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTM Investment Agent - Playground</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #1c2128;
            --border-color: #30363d;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-purple: #bc8cff;
            --accent-orange: #f0883e;
            --accent-red: #f85149;
            --hover-bg: #21262d;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background-color: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .sidebar-section {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-section h3 {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .endpoint-item {
            padding: 8px 12px;
            margin-bottom: 4px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .endpoint-item:hover {
            background-color: var(--hover-bg);
        }

        .endpoint-item.active {
            background-color: var(--accent-blue);
            color: #000;
            font-weight: 500;
        }

        .method-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .method-post { background-color: var(--accent-green); color: #000; }
        .method-get { background-color: var(--accent-blue); color: #000; }
        .method-patch { background-color: var(--accent-orange); color: #000; }
        .method-delete { background-color: var(--accent-red); color: #fff; }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            padding: 20px 30px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .header h2 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .request-panel, .response-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .request-panel {
            border-right: 1px solid var(--border-color);
        }

        .panel-header {
            padding: 15px 20px;
            background-color: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            font-size: 14px;
        }

        .panel-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: 'Monaco', 'Menlo', monospace;
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--accent-green);
            color: #000;
        }

        .btn-primary:hover {
            background-color: #2ea043;
        }

        .btn-secondary {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background-color: var(--hover-bg);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Code Block */
        .code-block {
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            line-height: 1.5;
        }

        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Status Badge */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .status-success {
            background-color: rgba(63, 185, 80, 0.2);
            color: var(--accent-green);
        }

        .status-error {
            background-color: rgba(248, 81, 73, 0.2);
            color: var(--accent-red);
        }

        .status-pending {
            background-color: rgba(240, 136, 62, 0.2);
            color: var(--accent-orange);
        }

        /* Loading */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .quick-action {
            padding: 8px 14px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-action:hover {
            background-color: var(--hover-bg);
            border-color: var(--accent-blue);
        }

        /* Info Box */
        .info-box {
            background-color: rgba(88, 166, 255, 0.1);
            border: 1px solid rgba(88, 166, 255, 0.3);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 13px;
            color: var(--accent-blue);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>üöÄ CTM Agent API</h1>
                <p>Investment Analysis Playground</p>
            </div>

            <div class="sidebar-section">
                <h3>Assistants</h3>
                <div class="endpoint-item" onclick="selectEndpoint('create-assistant')">
                    <span class="method-badge method-post">POST</span>
                    <span>Create Assistant</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('search-assistants')">
                    <span class="method-badge method-post">POST</span>
                    <span>Search Assistants</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('get-assistant')">
                    <span class="method-badge method-get">GET</span>
                    <span>Get Assistant</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Threads</h3>
                <div class="endpoint-item" onclick="selectEndpoint('list-threads')">
                    <span class="method-badge method-get">GET</span>
                    <span>List Threads</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('create-thread')">
                    <span class="method-badge method-post">POST</span>
                    <span>Create Thread</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('get-thread')">
                    <span class="method-badge method-get">GET</span>
                    <span>Get Thread</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('get-thread-state')">
                    <span class="method-badge method-get">GET</span>
                    <span>Get Thread State</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('inspect-thread')">
                    <span class="method-badge method-get">GET</span>
                    <span>üîç Inspect Thread</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Runs</h3>
                <div class="endpoint-item active" onclick="selectEndpoint('create-run-wait')">
                    <span class="method-badge method-post">POST</span>
                    <span>Run & Wait</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('create-run')">
                    <span class="method-badge method-post">POST</span>
                    <span>Create Run</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('list-runs')">
                    <span class="method-badge method-get">GET</span>
                    <span>List Runs</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>System</h3>
                <div class="endpoint-item" onclick="selectEndpoint('health')">
                    <span class="method-badge method-get">GET</span>
                    <span>Health Check</span>
                </div>
                <div class="endpoint-item" onclick="selectEndpoint('info')">
                    <span class="method-badge method-get">GET</span>
                    <span>Server Info</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h2 id="endpoint-title">Run Agent & Wait</h2>
                <p id="endpoint-description">Ejecuta el agente de inversiones CTM y espera el resultado</p>
            </div>

            <div class="content">
                <!-- Request Panel -->
                <div class="request-panel">
                    <div class="panel-header">üì§ Request</div>
                    <div class="panel-content">
                        <div class="quick-actions">
                            <div class="quick-action" onclick="loadExample('investment')">üìä Investment Analysis</div>
                            <div class="quick-action" onclick="loadExample('simple')">üí¨ Simple Query</div>
                            <div class="quick-action" onclick="clearRequest()">üóëÔ∏è Clear</div>
                        </div>

                        <div id="request-form">
                            <!-- Formulario din√°mico seg√∫n el endpoint -->
                        </div>

                        <div class="button-group">
                            <button class="btn btn-primary" onclick="sendRequest()">
                                ‚ñ∂Ô∏è Send Request
                            </button>
                            <button class="btn btn-secondary" onclick="copyRequest()">
                                üìã Copy as cURL
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Response Panel -->
                <div class="response-panel">
                    <div class="panel-header">üì• Response</div>
                    <div class="panel-content">
                        <div id="response-content">
                            <div class="info-box">
                                üëà Selecciona un endpoint y env√≠a una request para ver la respuesta aqu√≠
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentEndpoint = 'create-run-wait';
        let currentThreadId = null;
        let currentAssistantId = null;

        const API_BASE = window.location.origin;

        const endpoints = {
            'create-assistant': {
                title: 'Create Assistant',
                description: 'Crea un nuevo assistant (instancia del agente)',
                method: 'POST',
                url: '/assistants',
                form: `
                    <div class="form-group">
                        <label>Graph ID *</label>
                        <input type="text" id="graph_id" value="agent" placeholder="agent">
                    </div>
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="name" placeholder="CTM Investment Agent">
                    </div>
                    <div class="form-group">
                        <label>Metadata (JSON)</label>
                        <textarea id="metadata" placeholder='{"key": "value"}'>{}</textarea>
                    </div>
                `
            },
            'search-assistants': {
                title: 'Search Assistants',
                description: 'Busca assistants por criterios',
                method: 'POST',
                url: '/assistants/search',
                form: `
                    <div class="form-group">
                        <label>Graph ID</label>
                        <input type="text" id="graph_id" value="agent" placeholder="agent">
                    </div>
                    <div class="form-group">
                        <label>Limit</label>
                        <input type="number" id="limit" value="10">
                    </div>
                `
            },
            'get-assistant': {
                title: 'Get Assistant',
                description: 'Obtiene un assistant por ID',
                method: 'GET',
                url: '/assistants/{assistant_id}',
                form: `
                    <div class="form-group">
                        <label>Assistant ID *</label>
                        <input type="text" id="assistant_id" placeholder="Enter assistant ID">
                    </div>
                `
            },
            'list-threads': {
                title: 'List Threads',
                description: 'Lista todos los threads (conversaciones) disponibles',
                method: 'GET',
                url: '/threads',
                form: `
                    <div class="info-box">
                        üìã Este endpoint muestra todos los threads, incluyendo los de LangGraph Studio
                    </div>
                    <div class="form-group">
                        <label>Limit</label>
                        <input type="number" id="limit" value="20" placeholder="10">
                    </div>
                    <div class="form-group">
                        <label>Offset</label>
                        <input type="number" id="offset" value="0" placeholder="0">
                    </div>
                `
            },
            'create-thread': {
                title: 'Create Thread',
                description: 'Crea un nuevo thread (conversaci√≥n)',
                method: 'POST',
                url: '/threads',
                form: `
                    <div class="form-group">
                        <label>Thread ID (opcional)</label>
                        <input type="text" id="thread_id" placeholder="Auto-generado si se deja vac√≠o">
                    </div>
                    <div class="form-group">
                        <label>Metadata (JSON)</label>
                        <textarea id="metadata" placeholder='{"key": "value"}'>{}</textarea>
                    </div>
                `
            },
            'get-thread': {
                title: 'Get Thread',
                description: 'Obtiene informaci√≥n de un thread',
                method: 'GET',
                url: '/threads/{thread_id}',
                form: `
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Enter thread ID">
                    </div>
                `
            },
            'get-thread-state': {
                title: 'Get Thread State',
                description: 'Obtiene el estado completo del thread',
                method: 'GET',
                url: '/threads/{thread_id}/state',
                form: `
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Enter thread ID">
                    </div>
                `
            },
            'inspect-thread': {
                title: 'üîç Inspect Thread (Debug)',
                description: 'Inspecciona el estado detallado del thread para debugging',
                method: 'GET',
                url: '/threads/{thread_id}/inspect',
                form: `
                    <div class="info-box">
                        üîç Este endpoint muestra informaci√≥n detallada para debugging:
                        <ul style="margin: 10px 0 0 20px; font-size: 12px;">
                            <li>Nodo actual en el grafo</li>
                            <li>Tipo de interrupci√≥n (selecci√≥n, chat, etc.)</li>
                            <li>Detalles de la interrupci√≥n</li>
                            <li>Estado del proyecto (ProjectState)</li>
                            <li>Oportunidades encontradas/seleccionadas</li>
                        </ul>
                    </div>
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Enter thread ID">
                    </div>
                `
            },
            'create-run-wait': {
                title: 'Run Agent & Wait',
                description: 'Ejecuta el agente de inversiones CTM y espera el resultado',
                method: 'POST',
                url: '/threads/{thread_id}/runs/wait',
                form: `
                    <div class="info-box">
                        üí° Primero necesitas crear un Thread y un Assistant
                    </div>
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Crea un thread primero">
                    </div>
                    <div class="form-group">
                        <label>Assistant ID *</label>
                        <input type="text" id="assistant_id" placeholder="Crea un assistant primero">
                    </div>
                    <div class="form-group">
                        <label>Project Title</label>
                        <input type="text" id="project_title" placeholder="Proyecto de energ√≠a renovable">
                    </div>
                    <div class="form-group">
                        <label>Project Description</label>
                        <textarea id="project_description" placeholder="Describe el proyecto de inversi√≥n...">Proyecto de instalaci√≥n de paneles solares en zonas rurales de Colombia. Inversi√≥n estimada de $5M USD con retorno esperado en 3-5 a√±os.</textarea>
                    </div>
                `
            },
            'create-run': {
                title: 'Create Run',
                description: 'Crea una ejecuci√≥n sin esperar',
                method: 'POST',
                url: '/threads/{thread_id}/runs',
                form: `
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Enter thread ID">
                    </div>
                    <div class="form-group">
                        <label>Assistant ID *</label>
                        <input type="text" id="assistant_id" placeholder="Enter assistant ID">
                    </div>
                    <div class="form-group">
                        <label>Input (JSON)</label>
                        <textarea id="input" placeholder='{"messages": [{"role": "user", "content": "..."}]}'>{}</textarea>
                    </div>
                `
            },
            'list-runs': {
                title: 'List Runs',
                description: 'Lista todas las ejecuciones de un thread',
                method: 'GET',
                url: '/threads/{thread_id}/runs',
                form: `
                    <div class="form-group">
                        <label>Thread ID *</label>
                        <input type="text" id="thread_id" placeholder="Enter thread ID">
                    </div>
                    <div class="form-group">
                        <label>Limit</label>
                        <input type="number" id="limit" value="10">
                    </div>
                `
            },
            'health': {
                title: 'Health Check',
                description: 'Verifica el estado del servidor',
                method: 'GET',
                url: '/ok',
                form: `<div class="info-box">Este endpoint no requiere par√°metros</div>`
            },
            'info': {
                title: 'Server Info',
                description: 'Informaci√≥n y estad√≠sticas del servidor',
                method: 'GET',
                url: '/info',
                form: `<div class="info-box">Este endpoint no requiere par√°metros</div>`
            }
        };

        function selectEndpoint(endpointId) {
            currentEndpoint = endpointId;
            const endpoint = endpoints[endpointId];
            
            // Update UI
            document.getElementById('endpoint-title').textContent = endpoint.title;
            document.getElementById('endpoint-description').textContent = endpoint.description;
            document.getElementById('request-form').innerHTML = endpoint.form;
            
            // Update active state
            document.querySelectorAll('.endpoint-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.endpoint-item').classList.add('active');
            
            // Auto-fill thread_id and assistant_id if available
            if (currentThreadId && document.getElementById('thread_id')) {
                document.getElementById('thread_id').value = currentThreadId;
            }
            if (currentAssistantId && document.getElementById('assistant_id')) {
                document.getElementById('assistant_id').value = currentAssistantId;
            }
        }

        async function sendRequest() {
            const endpoint = endpoints[currentEndpoint];
            let url = API_BASE + endpoint.url;
            let body = null;
            
            // Build request based on method
            if (endpoint.method === 'GET') {
                // Replace path parameters
                const threadId = document.getElementById('thread_id')?.value;
                const assistantId = document.getElementById('assistant_id')?.value;
                
                if (threadId) url = url.replace('{thread_id}', threadId);
                if (assistantId) url = url.replace('{assistant_id}', assistantId);
                
                // Add query parameters
                const limit = document.getElementById('limit')?.value;
                if (limit) url += `?limit=${limit}`;
            } else {
                // POST/PATCH/DELETE - build body
                body = {};
                
                // Replace path parameters
                const threadId = document.getElementById('thread_id')?.value;
                const assistantId = document.getElementById('assistant_id')?.value;
                
                if (threadId && url.includes('{thread_id}')) {
                    url = url.replace('{thread_id}', threadId);
                } else if (threadId && !url.includes('/threads/')) {
                    // Thread ID is part of body
                    body.thread_id = threadId;
                }
                
                if (assistantId && url.includes('{assistant_id}')) {
                    url = url.replace('{assistant_id}', assistantId);
                }
                
                // Collect form data
                const form = document.getElementById('request-form');
                const inputs = form.querySelectorAll('input, textarea, select');
                
                inputs.forEach(input => {
                    if (input.value && input.id && !url.includes(`{${input.id}}`)) {
                        try {
                            // Try to parse JSON fields
                            if (input.id === 'metadata' || input.id === 'config' || input.id === 'input') {
                                body[input.id] = JSON.parse(input.value || '{}');
                            } else if (input.type === 'number') {
                                body[input.id] = parseInt(input.value);
                            } else {
                                body[input.id] = input.value;
                            }
                        } catch (e) {
                            body[input.id] = input.value;
                        }
                    }
                });
                
                // Special handling for create-run-wait
                if (currentEndpoint === 'create-run-wait') {
                    const projectTitle = document.getElementById('project_title')?.value;
                    const projectDesc = document.getElementById('project_description')?.value;
                    
                    body = {
                        assistant_id: assistantId,
                        input: {
                            project_title: projectTitle,
                            project_description: projectDesc,
                            messages: []
                        },
                        metadata: {},
                        stream_mode: ["values"]
                    };
                }
            }
            
            // Show loading
            showLoading();
            
            try {
                const options = {
                    method: endpoint.method,
                    headers: {
                        'Content-Type': 'application/json'
                    }
                };
                
                if (body) {
                    options.body = JSON.stringify(body);
                }
                
                const response = await fetch(url, options);
                const data = await response.json();
                
                // Save IDs for later use
                if (data.thread_id) currentThreadId = data.thread_id;
                if (data.assistant_id) currentAssistantId = data.assistant_id;
                
                // Generate cURL command
                const curlCommand = generateCurlCommand(url, endpoint.method, body);
                
                showResponse(response.status, data, curlCommand);
            } catch (error) {
                showResponse(500, { error: error.message });
            }
        }

        function showLoading() {
            document.getElementById('response-content').innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <div class="loading"></div>
                    <p style="margin-top: 15px; color: var(--text-secondary);">Procesando request...</p>
                </div>
            `;
        }

        function showResponse(status, data, curlCommand = null) {
            const statusClass = status >= 200 && status < 300 ? 'status-success' : 'status-error';
            const statusText = status >= 200 && status < 300 ? 'Success' : 'Error';
            
            let curlSection = '';
            if (curlCommand) {
                curlSection = `
                    <div style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h4 style="margin: 0; font-size: 14px; color: var(--text-secondary);">üìã cURL Command</h4>
                            <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;" onclick="copyCurlToClipboard()">
                                üìã Copy
                            </button>
                        </div>
                        <div class="code-block" style="background-color: var(--bg-primary);">
                            <pre id="curl-command" style="font-size: 12px;">${curlCommand}</pre>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('response-content').innerHTML = `
                <span class="status-badge ${statusClass}">${status} ${statusText}</span>
                ${curlSection}
                <h4 style="margin: 15px 0 10px 0; font-size: 14px; color: var(--text-secondary);">üì• Response Body</h4>
                <div class="code-block">
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;
        }

        function copyCurlToClipboard() {
            const curlText = document.getElementById('curl-command').textContent;
            navigator.clipboard.writeText(curlText);
            alert('‚úÖ cURL command copied to clipboard!');
        }

        function loadExample(type) {
            if (type === 'investment') {
                if (document.getElementById('project_title')) {
                    document.getElementById('project_title').value = 'Proyecto de Energ√≠a Solar';
                    document.getElementById('project_description').value = 'Instalaci√≥n de paneles solares en zonas rurales de Colombia. Inversi√≥n estimada de $5M USD con retorno esperado en 3-5 a√±os. Beneficiar√° a 10,000 familias.';
                }
            } else if (type === 'simple') {
                if (document.getElementById('project_title')) {
                    document.getElementById('project_title').value = 'An√°lisis Simple';
                    document.getElementById('project_description').value = 'Analiza oportunidades de inversi√≥n en tecnolog√≠a';
                }
            }
        }

        function clearRequest() {
            const form = document.getElementById('request-form');
            const inputs = form.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                if (input.type !== 'number') {
                    input.value = '';
                }
            });
        }

        function copyRequest() {
            // Get current form data to generate accurate cURL
            const endpoint = endpoints[currentEndpoint];
            let url = API_BASE + endpoint.url;
            let body = null;
            
            // Build body same way as sendRequest
            if (endpoint.method !== 'GET') {
                body = {};
                const form = document.getElementById('request-form');
                const inputs = form.querySelectorAll('input, textarea, select');
                
                inputs.forEach(input => {
                    if (input.value && input.id) {
                        try {
                            if (input.id === 'metadata' || input.id === 'config' || input.id === 'input') {
                                body[input.id] = JSON.parse(input.value || '{}');
                            } else if (input.type === 'number') {
                                body[input.id] = parseInt(input.value);
                            } else {
                                body[input.id] = input.value;
                            }
                        } catch (e) {
                            body[input.id] = input.value;
                        }
                    }
                });
            }
            
            const curl = generateCurlCommand(url, endpoint.method, body);
            navigator.clipboard.writeText(curl);
            alert('‚úÖ cURL command copied to clipboard!');
        }

        function generateCurlCommand(url, method, body) {
            let curl = `curl -X ${method} "${url}"`;
            
            if (method !== 'GET') {
                curl += ` \\
  -H "Content-Type: application/json"`;
                if (body && Object.keys(body).length > 0) {
                    curl += ` \\
  -d '${JSON.stringify(body, null, 2)}'`;
                }
            }
            
            return curl;
        }

        // Initialize
        selectEndpoint('create-run-wait');
    </script>
</body>
</html>
